<style>
    #battlefield {
        margin: auto;
        width: 50%;
        padding: 10px;
        list-style-type:none;
    }
</style>

<script>
    const redrawBattleFieldFromState = (state) => {
        const id = "test";
        const battleField = new Array(state.sizeX).fill(Array(state.sizeY).fill(drawObject("empty")));
        Object.keys(state.objects).forEach(objectKey => {
            const object = state.objects[objectKey];
            battleField[object.position.x][object.position.y] = drawObject(object.id === id ? "id": "player");
        });
        const battleFieldDom = document.getElementById("battlefield");
        battleFieldDom.innerHTML = "";
        battleField.forEach(yarray => {
            const text = yarray.join(drawObject("space"));
            const li = document.createElement("LI");
            li.innerText = text;
            battleFieldDom.appendChild(li);
        })
    };

    const drawObject = (type) => {
        const drawLibrary = {
            "empty": "*",
            "id": "U", 
            "player": "M",
            "monster": "D",
            "space": " "
        };
        if (drawLibrary[type]) {
            return drawLibrary[type];
        } else {
            return "?";
        }
    };

    const socketInitialization = () =>  {
        const socket = io();
//        $('form').submit(function(){
//            socket.emit('chat message', $('#m').val());
//            $('#m').val('');
//            return false;
//        });
        // tells the player the current state
        socket.on('state', function(msg){
            console.log(msg);
        });
        // tells the player his id
        socket.on('id', function(msg){

            console.log(msg);
        });
    };

    window.onload = () => {
        redrawBattleFieldFromState({sizeX: 25, sizeY: 25, objects:{}});
        socketInitialization();
    }

</script>

<body>
<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>

<ul id="battlefield">
</ul>
</body>